%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
%                              Required Packages                               %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Required for creating documents
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\RequirePackage{etex}

% Required math packages
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathrsfs}

\usepackage{multicol} % for multiple columns
\usepackage[usenames,dvipsnames,pdftex]{color} % Required for nicer colors
\usepackage{hyperref} % Required for hyperlinks
\usepackage{xparse} % Required for \NewDocumentCommand
\usepackage{graphicx} % Required for including images
\usepackage{enumitem} % Required for customizing lists
\usepackage{float} % Required for positioning figures and tables
\usepackage{array} % Required for customizing tables
\usepackage{systeme} % Required for \systeme
\usepackage{cancel} % Required for \cancel
\usepackage{derivative} % Required for \odv and \pdv
\usepackage{authoraftertitle} % Required for \MyTitle
\usepackage{geometry} % Required for customizing page layout
\usepackage{textgreek} % Required for greek letters in text mode
\usepackage{multirow} % Required for multirow in tables
\usepackage{emptypage} % Required for removing page numbers on empty pages
\usepackage{nicematrix} % Required for better matrices
\usepackage{booktabs} % Required for better tables
\usepackage{cellspace} % Required for better spacing in tables
\usepackage{longtable} % Required for long tables
\usepackage{xfrac} % Required for extra fraction options
\usepackage{diagbox} % Required for creating diagonal boxes
\usepackage{polynom} % Required for polynomial long division
\usepackage{setspace} % For line spacing

\usepackage[font=bf]{caption} % Required for customizing captions
\usepackage{subcaption} % Required for creating subfigures
\usepackage{siunitx} % Required for SI units
\usepackage{titletoc} % Required for customizing table of contents
\usepackage{braket} % Required for creating braket notation

% Required for drawing figures
\usepackage{tikz}
\usepackage{pgffor}
\usepackage{tkz-euclide}
\usepackage{tikz-cd}
\usepackage{tikz-3dplot}
\usepackage{circuitikz}

% Required for creating plots
\usepackage{pgfplots}
\usepackage{pgfplotstable}

\usepackage{titling} % Required for customizing title page
\usepackage{ifthen} % Required for if-then-else statements
\usepackage{xifthen} % Required for if-then-else statements
\usepackage{fancyhdr} % Required for customizing headers and footers
\usepackage{import} % Required for importing pdf_tex files
\usepackage{titlesec} % Required for customizing sectioning commands
\usepackage{etex} % Required for more registers

% Required for creating boxes
\usepackage[most,many,breakable]{tcolorbox}

\makeatletter


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
%                                Basic Settings                                %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifx\nauthor\undefined
  \def\nauthor{Hashem A. Damrah}
\else
\fi

\ifx\class\undefined
  \def\class{report}
\else
\fi

\newcommand\globalcolor[1]{%
  \color{#1}\global\let\default@color\current@color
}

% Symbols
\let\oldlimsymbol\lim\renewcommand\lim{\displaystyle\oldlimsymbol}
\let\oldsumsymbol\sum\renewcommand\sum{\displaystyle\oldsumsymbol}
\let\oldlimsupsymbol\limsup\renewcommand\limsup{\displaystyle\oldlimsupsymbol}
\let\oldliminfsymbol\liminf\renewcommand\liminf{\displaystyle\oldliminfsymbol}
\let\implies\Rightarrow
\let\impliedby\Leftarrow
\let\iff\Leftrightarrow
\let\epsilon\varepsilon

% Geometry
\geometry{
  top=1in,
  bottom=1in,
  right=1in,
  left=1in,
}

% Tables
\newcolumntype{C}{>{\Centering\arraybackslash}X}
\setlength{\tabcolsep}{5pt}
\renewcommand\arraystretch{1.5}
\renewcommand\thetable{\Roman{table}}
\captionsetup[figure]{font=small}
\captionsetup{justification=centering}
\setlength\cellspacetoplimit{6pt}
\setlength\cellspacebottomlimit{6pt}

% Lists
\renewcommand{\labelitemi}{--}
\renewcommand{\labelitemii}{$\circ$}
\renewcommand{\labelenumi}{\textnormal{(\roman{*})}}

% Center Title Page
\let\@real@maketitle\maketitle
% \renewcommand\maketitle{
%   \@real@maketitle
%   \begin{center}
%     \begin{minipage}[c]{0.9\textwidth}
%       \centering\footnotesize
%       These notes are not endorsed by the lecturers, and
%       I have modified them (often significantly) after lectures. They are
%       nowhere near accurate representations of what was actually lectured, and
%       in particular, all errors are almost surely mine.

%       \textit{Disclaimer:} This document will inevitably contain some
%       mistakes--both simple typos and legitimate errors. Keep in mind that these
%       are the notes of an undergraduate student in the process of learning the
%       material himself, so take what you read with a grain of salt. If you find
%       mistakes and feel like telling me, I will be grateful and happy to hear
%       from you, even for the most trivial of errors. You can reach me by email,
%       in English, Arabic, Hebrew, or Spanish at
%       \href{mailto:singularisartt@gmail.com}{singularisartt@gmail.com}.
%     \end{minipage}
%   \end{center}
% }
\renewcommand\maketitlehooka{\null\mbox{}\vfill}
\renewcommand\maketitlehookd{\vfill\null}

% Footnote Line
\renewcommand\footnoterule{\hrule\vspace{0.1cm}}

% Modify Links Color
\hypersetup{
  colorlinks,
  linkcolor=black!90,
  citecolor=black,
  urlcolor=cyan!70!black,
}

%%%%%%%%%%
%  TikZ  %
%%%%%%%%%%

\usetikzlibrary{
  shadings,
  intersections,
  angles,
  quotes,
  calc,
  positioning,
  3d,
  perspective,
  arrows,
  arrows.meta,
  patterns,
  decorations.markings,
  bending,
  decorations.pathreplacing,
  calligraphy,
  backgrounds,
}

\tikzoption{canvas is xy plane at z}[]{%
	\def\tikz@plane@origin{\pgfpointxyz{0}{0}{#1}}%
	\def\tikz@plane@x{\pgfpointxyz{1}{0}{#1}}%
	\def\tikz@plane@y{\pgfpointxyz{0}{1}{#1}}%
	\tikz@canvas@is@plane}

\usetikzlibrary{shapes.arrows}
\newcommand\graphslopefield{
  \pgfmathsetmacro{\hx}{(\xmax-\xmin)/\nx}
  \pgfmathsetmacro{\hy}{(\ymax-\ymin)/\ny}
  \foreach \i in {0,...,\nx}
  \foreach \j in {0,...,\ny}{
    \pgfmathsetmacro{\yprime}{f({\xmin+\i*\hx},{\ymin+\j*\hy})}
    \draw[black,shift={({\xmin+\i*\hx},{\ymin+\j*\hy})}]
    (0,0)--($(0,0)!2mm!(.1,.1*\yprime)$);
  }

  \draw[->] (\xmin-.5,0)--(\xmax+.5,0) node[below right] {$x$};
  \draw[->] (0,\ymin-.5)--(0,\ymax+.5) node[above left] {$y$};
}

\tikzset{derivative/.style={color=gray,mark=none,line width=0.5pt,solid}}
\tikzset{asymptote/.style={color=gray,mark=none,line width=1pt,<->,dashed}}
\tikzset{soldot/.style={color=black,fill=black,only marks,mark=*}}
\tikzset{holdot/.style={color=black,fill=white,only marks,mark=*}}

\tikzset{>=stealth}
\tikzset{->-/.style={decoration={markings,mark=at position .5 with {\arrow{>}}},postaction={decorate}}}

%%%%%%%%%%%%%%
%  PgfPlots  %
%%%%%%%%%%%%%%

\pgfplotsset{width=7cm,compat=1.8}
\pgfplotsset{compat=newest}

\usepgfplotslibrary{patchplots}
\usepgfplotslibrary{fillbetween}
\usetikzlibrary{intersections}

\pgfplotsset{plot/.style={color=red,mark=none,line width=1pt,<->,solid}}
\pgfplotsset{asymptote/.style={color=gray,mark=none,line width=1pt,<->,dashed}}
\pgfplotsset{soldot/.style={color=red,only marks,mark=*}}
\pgfplotsset{holdot/.style={color=red,fill=white,only marks,mark=*}}
\pgfplotsset{blankgraph/.style={xmin=-10,xmax=10,ymin=-10,ymax=10,axis line style= {-, draw opacity=0 },axis lines=box,major tick length=0mm,xtick={-10,-9,...,10},ytick={-10,-9,...,10},grid=major,yticklabels={,,},xticklabels={,,},minor xtick=,minor ytick=,xlabel={},ylabel={},width=0.75\textwidth,grid style={solid,gray!40}}}

\pgfplotscreateplotcyclelist{stylelist}{
  plot \\
}

\def\axisdefaultwidth{175pt}
\def\axisdefaultheight{\axisdefaultwidth}

\pgfplotsset{every axis/.append style={
    axis x line=middle,
    axis y line=middle,
    axis line style={<->},
    xlabel={$x$},
    ylabel={$y$},
    xmin=-7,xmax=7,
    ymin=-7,ymax=7,
    yticklabel style={inner sep=0.333ex},
    minor xtick={-7,-6,...,7},
    minor ytick={-7,-6,...,7},
    scale only axis,
    cycle list name=stylelist,
    tick label style={font=\footnotesize},
    legend cell align=left,
    grid=minor,
    grid style={solid,gray!40},
    try min ticks=6,
  },
  framed/.style={axis background/.style={draw=gray}}
}

\pgfplotsset{axis background/.style={draw=gray}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
%                           School Specific Commands                           %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%
%  Helpful Commands  %
%%%%%%%%%%%%%%%%%%%%%%

\newcommand\resetcounters{
  \setcounter{section}{0}
  \setcounter{subsection}{0}
  \setcounter{subsubsection}{0}
  \setcounter{paragraph}{0}
  \setcounter{subparagraph}{0}
}

\newcommand*\cleartoleftpage{%
  \clearpage
  \thispagestyle{empty}
  \ifodd\value{page}\else\hbox{}\newpage\fi
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Lecture/Chapter Command  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\notenum{}
\def\@note{}%
\newcommand\lecture[3]{
  \ifthenelse{\isempty{#3}}{%
    \def\@note{Lecture #1}%
  }{%
    \def\@note{Lecture #1: #3}%
  }%
  \section*{\@note\hfill{\small\textnormal{#2}}}
}

% Intro
\newcommand\createintro{
  \maketitle

  \pagenumbering{roman}
  \begin{center}
    \textbf{{\LARGE Introduction}}
    \phantomsection\addcontentsline{toc}{chapter}{0\hspace{0.8em}Introduction}
  \end{center}

  \begingroup
  \IfFileExists{./intro.tex}{
    \setlength{\parindent}{1cm}
    \input{intro.tex}
  }{}
  \endgroup

  \pagestyle{fancy}
  \renewcommand\headrulewidth{0pt}

  \fancyhead{}
  \fancyfoot[C]{%
    \textit{For more notes like this, visit \href{\linktootherpages}{\shortlinkname}}.%
  }%

  \begin{tcolorbox}[
      enhanced,
      colback=white,
      center upper,
      size=fbox,
      drop shadow southwest,
      sharp corners,
    ]
    \term: \academicyear, \\
    Last Update: \today, \\
    \faculty, \location.
  \end{tcolorbox}

  \newpage
  \tableofcontents

  \pagenumbering{arabic}
  \setcounter{page}{1}

  \renewcommand\headrulewidth{0.4pt}
  \fancyhead[R]{\@note}
  \fancyhead[L]{\nauthor}
  \fancyfoot[C]{\thepage}
}

%%%%%%%%%%%%%%%%%%%%%
%  Random Commands  %
%%%%%%%%%%%%%%%%%%%%%

% Circle
\newcommand*\circled[1]{
  \tikz[baseline=(char.base)] {
    \node[shape=circle,draw,inner sep=1pt] (char) {#1};
  }
}

% Import Figures
\newcommand\incimg[2][1]{%
  \includegraphics[width=#1\columnwidth]{figures/#2}%
}

\newcommand\incfig[2][1]{
  \def\svgwidth{#1\columnwidth}
  \import{figures}{#2.pdf_tex}
}

% Correct
\newcommand\correct[1]{\textcolor{correct}{#1}}
\newcommand\incorrect[1]{{\color{incorrect}#1}}
\newcommand\inctocor[2]{\incorrect{#1} \ensuremath{\to} \correct{#2}}

% Bracket
\renewcommand\bra[1]{\left\langle#1\right|}
\renewcommand\ket[1]{\left|#1\right\rangle}
\renewcommand\braket[2]{\left\langle#1\middle|#2\right\rangle}
\renewcommand\ang[1]{\left\langle#1\right\rangle}

% For diagonal strikeout in red
\newcommand\rcancel[1]{\renewcommand\CancelColor{\color{red}}\cancel{#1}}

% Logic
\renewcommand\nmid{\not|~}

% For differentials
\newcommand\dd[1]{\textrm{d}#1}
\newcommand\dA{\textrm{d}A}
\newcommand\dm{\textrm{d}m}
\newcommand\dt{\textrm{d}t}
\newcommand\dT{\textrm{d}T}
\newcommand\du{\textrm{d}u}
\newcommand\dv{\textrm{d}v}
\newcommand\dx{\textrm{d}x}
\newcommand\dy{\textrm{d}y}
\newcommand\dz{\textrm{d}z}

% Helpful text in math
\newcommand\abs{\text{abs}}
\newcommand\echelon{\underrightarrow{\textrm{ echelon form }}}
\newcommand\rref{\underrightarrow{\textrm{ rref }}}
\newcommand\pick[1]{\xrightarrow[#1]{\textrm{ pick }}}
\newcommand\generalsol{\xrightarrow[\textrm{solution}]{\textrm{ general }}}
\newcommand\ngeneralsol{\parbox{4em}{general \\ solution}\textrm{:}}
\renewcommand\and{\text{and}}
\newcommand\aand{\quad\text{and}\quad}
\newcommand\adj{\text{adj}}
\newcommand\qtq[1]{\quad\textrm{#1}\quad}
\newcommand\oor{\quad\text{or}\quad}
\newcommand\Col{\textrm{Col}}
\newcommand\Nul{\textrm{Null}}
\newcommand\range{\textrm{Range}}
\newcommand\Tr{\textrm{Tr}}
\newcommand\Row{\textrm{Row}}
\newcommand\rank{\textrm{rank}}
\newcommand\dist{\text{dist}}
\newcommand\sz{\stackrel{\textrm{set}}{=}}
\newcommand\ce{\overset{\checkmark}{=}}
\newcommand\proj{\text{proj}}
\newcommand\comp{\text{comp}}
\newcommand\Card{\text{Card}}
\renewcommand\mod{\text{mod}}
\newcommand\st{\text{such that}}
\newcommand\geogebra{\textsf{GeoGebra}}
\newcommand\Sspan{\text{Span}}
\renewcommand\Re{\text{Re}}
\renewcommand\Im{\text{Im}}

% Laplace
\newcommand\laplace[1]{\mathscr{L}\left\{#1\right\}}
\newcommand\ilaplace[1]{\mathscr{L}^{-1}\left\{#1\right\}}

% Vectors
\renewcommand\a{\mathbf{a}}
\renewcommand\b{\mathbf{b}}
\renewcommand\c{\mathbf{c}}
\renewcommand\d{\mathbf{d}}
\newcommand\e{\mathbf{e}}
\newcommand\f{\mathbf{f}}
\newcommand\g{\mathbf{g}}
\newcommand\n{\mathbf{n}}
\newcommand\p{\mathbf{p}}

\newcommand\RR{\mathbf{R}}
\newcommand\FF{\mathbf{F}}

\renewcommand\r{\mathbf{r}}
\newcommand\rr{\mathbf{r}^{\prime}}
\newcommand\rrr{\mathbf{r}^{\prime\prime}}

\newcommand\Ta{\mathbf{T}}
\newcommand\Taa{\mathbf{T}^{}}

\renewcommand\u{\mathbf{u}}
\newcommand\uu{\mathbf{u}^{\prime}}
\newcommand\uuu{\mathbf{u}^{\prime\prime}}

\renewcommand\v{\mathbf{v}}
\newcommand\vv{\mathbf{v}^{\prime}}
\newcommand\vvv{\mathbf{v}^{\prime\prime}}

\newcommand\w{\mathbf{w}}
\newcommand\x{\mathbf{x}}
\newcommand\y{\mathbf{y}}
\newcommand\z{\mathbf{z}}

\newcommand\zero{\mathbf{0}}

% Hat vectors
\newcommand\ah{\hat{\mathbf{a}}}
\newcommand\bh{\hat{\mathbf{b}}}
\newcommand\ch{\hat{\mathbf{c}}}
\renewcommand\dh{\hat{\mathbf{d}}}
\newcommand\eh{\hat{\mathbf{e}}}
\newcommand\ph{\hat{\mathbf{p}}}
\newcommand\uh{\hat{\mathbf{u}}}
\newcommand\vh{\hat{\mathbf{v}}}
\newcommand\wh{\hat{\mathbf{w}}}
\newcommand\xh{\hat{\mathbf{x}}}
\newcommand\yh{\hat{\mathbf{y}}}
\newcommand\zh{\hat{\mathbf{z}}}

% Unit vectors
\newcommand\ui{\mathbf{i}}
\newcommand\uj{\mathbf{j}}
\newcommand\uk{\mathbf{k}}

% Subspaces
\newcommand\B{\mathcal{B}}
\newcommand\CC{\mathbb{C}}
\newcommand\C{\mathcal{C}}
\newcommand\D{\mathcal{D}}
\newcommand\E{\mathcal{E}}
\newcommand\F{\mathcal{F}}
\newcommand\I{\mathbb{I}}
\newcommand\N{\mathbb{N}}
\newcommand\Q{\mathbb{Q}}
\newcommand\R{\mathbb{R}}
\newcommand\U{\mathcal{U}}
\newcommand\W{\mathbf{w}}
\newcommand\X{\mathcal{X}}
\newcommand\Y{\mathcal{Y}}
\newcommand\Z{\mathbb{Z}}

% Create command to box equations
\newcommand*\colorboxed{}
\def\colorboxed#1#{%
  \colorboxedAux{#1}%
}
\newcommand*\colorboxedAux[3]{%
  \begingroup
    \colorlet{cb@saved}{.}%
    \color#1{#2}%
    \boxed{%
      \color{cb@saved}%
      #3%
    }%
  \endgroup
}
\newcommand\empheq[1]{%
  \colorboxed{black}{%
    \begin{aligned}[b]
      #1
    \end{aligned}%
  }%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
%                                 Environments                                 %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{definition}
\newtheorem*{assumption}{Assumption}
\newtheorem*{claim}{Claim}
\newtheorem*{conjecture}{Conjecture}
\newtheorem*{definition}{Definition}
\newtheorem*{example}{Example}
\newtheorem*{notation}{Notation}
\newtheorem*{proposition}{Proposition}
\newtheorem*{question}{Question}
\newtheorem*{problem}{Problem}
\newtheorem*{rrule}{Rule}

\newtheorem*{remark}{Remark}
\newtheorem*{note}{Note}
\newtheorem*{warning}{Warning}

\theoremstyle{plain}
\newtheorem*{corollary}{Corollary}
\newtheorem*{lemma}{Lemma}
\newtheorem*{theorem}{Theorem}
\newtheorem*{worksheet}{Worksheet}

\newcommand\frmebox[1][]{%
  \begin{tcolorbox}[%
    title={\sffamily\color{black}#1},
    colback=white,
    enhanced,
    attach boxed title to top center={
      yshift=-3mm,
      yshifttext=-1mm,
    },
    boxed title style={
      size=small,
      colback=white,
      frame code={},
    },
    coltext=black,
    frame hidden,
    borderline east={0.5pt}{0pt}{black},
    borderline west={0.5pt}{0pt}{black},
    borderline north={0.5pt}{0pt}{black},
    borderline south={0.5pt}{0pt}{black},
    breakable,
    parskip=0pt,
  ]
}

\renewenvironment{frame}[1][]{%
  \frmebox[#1]%
}{%
  \end{tcolorbox}%
}

\makeatother
