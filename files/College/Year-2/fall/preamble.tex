%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                Basic Packages                               %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{hyperref}
\hypersetup{
  colorlinks,
  linkcolor=blue,
  citecolor={black},
  urlcolor={blue!80!black}
}
\usepackage{lipsum}
\usepackage{graphicx,wrapfig}
\usepackage{float}
\usepackage{multicol}
\usepackage[usenames,dvipsnames,pdftex]{xcolor}
\usepackage{amsmath,amsfonts,mathtools,amsthm,amssymb}
\usepackage{cancel}
\usepackage{xifthen}
\usepackage{tcolorbox}
\usepackage{float}
\usepackage{extramarks}
\usepackage[export]{adjustbox}
\usepackage{caption}
\usepackage{acro}
\usepackage{fancyhdr}
\usepackage{import}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{thmtools}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{siunitx}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{pgfplots}
\usepackage{titling}
\usepackage{xargs}
\usepackage[colorinlistoftodos]{todonotes}
\def\class{article}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                Basic Settings                               %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%
%  Symbols  %
%%%%%%%%%%%%%

\let\svlim\lim\def\lim{\svlim\limits}
\let\implies\Rightarrow
\let\impliedby\Leftarrow
\let\iff\Leftrightarrow
\let\epsilon\varepsilon

%%%%%%%%%%%%
%  Tables  %
%%%%%%%%%%%%

\setlength{\tabcolsep}{5pt}
\renewcommand\arraystretch{1.5}

%%%%%%%%%%%%%%%%%%
% Figure Support %
%%%%%%%%%%%%%%%%%%

\pdfminorversion=7
\newcommand\incfig[2][1]{%
  \def\svgwidth{#1\columnwidth}
  \import{./figures/}{#2.pdf_tex}
}

\pdfsuppresswarningpagegroup=1

%%%%%%%%%%%%%
%  Correct  %
%%%%%%%%%%%%%

\definecolor{correct}{HTML}{009900}
\newcommand\correct[2]{{\color{red}{#1 }}\ensuremath{\to}{\color{correct}{ #2}}}

%%%%%%%%%%%%%%
%  SI Unitx  %
%%%%%%%%%%%%%%

\sisetup{locale = FR}

%%%%%%%%%%
%  TikZ  %
%%%%%%%%%%

\usetikzlibrary{intersections, angles, quotes, calc, positioning}
\usetikzlibrary{arrows.meta}
\pgfplotsset{compat=1.13}

\tikzset{
  force/.style={thick, {Circle[length=2pt]}-stealth, shorten <=-1pt}
}

%%%%%%%%%%%%%%%%%%%%%%%
%  Center Title Page  %
%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand\maketitlehooka{\null\mbox{}\vfill}
\renewcommand\maketitlehookd{\vfill\null}

%%%%%%%%%%
%  Todo  %
%%%%%%%%%%

\makeatletter
\@ifclasswith{\class}{working}{
  \newcommand\unsure[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
  \newcommand\change[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
  \newcommand\info[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
  \newcommand\improvement[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}

  \newcommand\listnotes{
    \newpage
    \listoftodos[Notes]
  }
}{
  \newcommand\unsure[2][1=]{}
  \newcommand\change[2][1=]{}
  \newcommand\info[2][1=]{}
  \newcommand\improvement[2][1=]{}

  \newcommand\listnotes{}
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Put things in the background of images  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \usepackage{eso-pic}

% \definecolor{reallylightgray}{HTML}{FAFAFA}
% \AddToShipoutPicture{
%   \ifthenelse{\isodd{\thepage}}{
%     \AtPageLowerLeft{
%       \put(\LenToUnit{\dimexpr\paperwidth-222pt},0){
%         \color{reallylightgray}\rule{222pt}{297mm}
%       }
%     }
%   }
%   {
%     \AtPageLowerLeft{
%       \color{reallylightgray}\rule{222pt}{297mm}
%     }
%   }
% }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           School Specific Commands                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Initiate New Counters  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcounter{lecturecounter}
\newcounter{exercisecounter}
\newcounter{solutioncounter}

%%%%%%%%%%%%%%%%%%%%%
%  Lecture Command  %
%%%%%%%%%%%%%%%%%%%%%

\def\testdateparts#1{\dateparts#1\relax}
\def\dateparts#1 #2 #3 #4 #5\relax{
  \hspace*{\fill}\small\textsf{\mbox{#1 #2 #3 #5}}
}

\makeatletter

\def\@lesson{}
\newcommand\lesson[3][\arabic{lecturecounter}]{
  \addtocounter{lecturecounter}{1}
  \setcounter{section}{#1}
  \setcounter{exercisecounter}{0}
  \setcounter{solutioncounter}{0}
  \renewcommand\thesubsection{#1.\arabic{subsection}}

  \ifthenelse{\isempty{#3}}{
    \def\@lesson{Lecture \arabic{lecturecounter}}
  }{
    \def\@lesson{Lecture \arabic{lecturecounter}: #3}
  }
  \testdateparts{#2}
  \hrule
  \vspace*{-0.3cm}
  \section*{\@lesson}
  \addcontentsline{toc}{section}{\@lesson}
}

%%%%%%%%%%%%%%%%%%%%%%
%  Exercise Command  %
%%%%%%%%%%%%%%%%%%%%%%

\def\@exercise{}
\newcommand\exercise[1][\arabic{exercisecounter}]{
  \addtocounter{exercisecounter}{1}
  \def\@exercise{Exercise \arabic{section}.#1}
  \subsection*{\@exercise}
  \addcontentsline{toc}{subsection}{\@exercise}
}

%%%%%%%%%%%%%%%%%%%%%%
%  Solution Command  %
%%%%%%%%%%%%%%%%%%%%%%

\def\@solution{}
\newcommand\solution[1][\arabic{solutioncounter}]{
  \addtocounter{solutioncounter}{1}
  \def\@solution{Solution \arabic{section}.#1}
  \subsection*{\@solution}
  \addcontentsline{toc}{subsection}{\@solution}
}


%%%%%%%%%%%%%%%%%
% Fancy Headers %
%%%%%%%%%%%%%%%%%

\newcommand\forcenewpage{\clearpage\mbox{~}\clearpage\newpage}
\newcommand\createintro{
  \pagenumbering{roman}

  \maketitle
  \thispagestyle{empty}
  \newpage
  \input{intro}

  \pagestyle{fancy}
  \renewcommand\headrulewidth{0pt}
  \fancyhead{}
  \fancyfoot[C]{
    \textit{For more notes like this, visit
    \href{singularisart.github.io/notes}{singularisart.github.io/notes}}. \\
    \vspace{0.1cm}
    \hrule
    \vspace{0.1cm}
    Hashem A. Damrah, \\
    \term: \academicyear, \\
    Last Update: \today, \\
    \faculty
  }

  \newpage

  \fancyfoot[C]{\thepage}
  \tableofcontents
  \forcenewpage

  \pagestyle{fancy}
  \pagenumbering{arabic}
  \setcounter{page}{1}

  \renewcommand\headrulewidth{0.4pt}
  \fancyhead[R]{\@lesson}
  \fancyhead[L]{Hashem A. Damrah}
  \fancyfoot[C]{\thepage}
}

\makeatother


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                 Environments                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\mdfsetup{skipabove=1em,skipbelow=0em}

% \renewcommand\qed{\hfill\color{RawSienna}{Q.E.D.}}
\renewcommand\qed{\hfill\color{RawSienna}$\blacksquare$}

\theoremstyle{definition}

\newcommand\createnewtheorem[3]{
  \declaretheoremstyle[
  headfont=\bfseries\sffamily, bodyfont=\normalfont, #3,
  mdframed={
    #2
  },
  ]{#1}
}

\newcommand\createcoloredtheorem[8]{
  \createnewtheorem{#1}{
    linewidth=2pt,
    rightline=#3, leftline=#4, topline=#5, bottomline=#6,
    linecolor=#2, backgroundcolor=#2!5, #7
  }{headfont=\bfseries\sffamily\color{#2}, #8}
}

\makeatletter
\@ifclasswith{\class}{nocolor}{
  % No color environments.
  \createnewtheorem{thmgreenbox}{}{}
  \createnewtheorem{thmredbox}{}{}
  \createnewtheorem{thmbluebox}{}{}
  \createcoloredtheorem{thmrednolines}{RawSienna}{false}{false}{false}{false}{backgroundcolor=white}{}
  \createnewtheorem{thmblueline}{rightline=false, topline=false, bottomline=false}{}
  \createnewtheorem{thmproofbox}{rightline=false, topline=false, bottomline=false}{qed=\qedsymbol}
}{
  % Color environments.
  \createcoloredtheorem{thmgreenbox}{ForestGreen}{false}{true}{false}{false}{}{}
  \createcoloredtheorem{thmredbox}{RawSienna}{false}{true}{false}{false}{}{}
  \createcoloredtheorem{thmbluebox}{NavyBlue}{false}{true}{false}{false}{}{}
  \createcoloredtheorem{thmblueline}{NavyBlue}{false}{true}{false}{false}{backgroundcolor=white}{}
  \createcoloredtheorem{thmproofbox}{RawSienna}{false}{true}{false}{false}{backgroundcolor=white}{qed=\qedsymbol}
}
\makeatother

\declaretheorem[numberwithin=section, style=thmgreenbox, name=Definition]{definition}
\declaretheorem[sibling=definition, style=thmredbox, name=Corollary]{corollary}
\declaretheorem[sibling=definition, style=thmredbox, name=Proposition]{prop}
\declaretheorem[sibling=definition, style=thmredbox, name=Theorem]{theorem}
\declaretheorem[sibling=definition, style=thmredbox, name=Lemma]{lemma}
\declaretheorem[numbered=no, style=thmproofbox, name=Proof]{replacementproof}
\declaretheorem[numbered=no, style=thmblueline, name=Proof]{expl}
\declaretheorem[style=thmbluebox, numbered=no, name=Example]{example}
\declaretheorem[style=thmblueline, numbered=no, name=Remark]{remark}

\renewenvironment{proof}[1][\proofname]{\vspace{-10pt}\begin{replacementproof}}{\end{replacementproof}}
\newenvironment{explanation}[1][\proofname]{\vspace{-10pt}\begin{expl}}{\end{expl}}

\newenvironment{myproof}[1][\proofname]{%
  \proof[\rm \bf #1]%
}{\endproof}

\newtheorem*{notation}{Notation}
\newtheorem*{previouslyseen}{As previously seen}
\newtheorem*{problem}{Problem}
\newtheorem*{observe}{Observe}
\newtheorem*{property}{Property}
\newtheorem*{intuition}{Intuition}
\newtheorem*{note}{Note}
