%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                Basic Packages                               %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Gives us multiple colors.
\usepackage[usenames,dvipsnames,pdftex]{xcolor}
% Let's us style link colors.
\usepackage{hyperref}
% Let's us import images and graphics.
\usepackage{graphicx}
% Let's us use figures in floating environments.
\usepackage{float}
% Let's us create multiple columns.
\usepackage{multicol}
% Gives us better math syntax.
\usepackage{amsmath,amsfonts,mathtools,amsthm,amssymb}
% Let's us strikethrough text.
\usepackage{cancel}
% Let's us edit the caption of a figure.
\usepackage{caption}
% Let's us import pdf directly in our tex code.
\usepackage{pdfpages}
\def\class{article}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                Basic Settings                               %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%
%  Symbols  %
%%%%%%%%%%%%%

\let\implies\Rightarrow
\let\impliedby\Leftarrow
\let\iff\Leftrightarrow
\let\epsilon\varepsilon

%%%%%%%%%%%%
%  Tables  %
%%%%%%%%%%%%

\setlength{\tabcolsep}{5pt}
\renewcommand\arraystretch{1.5}

%%%%%%%%%%%%%%
%  SI Unitx  %
%%%%%%%%%%%%%%

\usepackage{siunitx}
\sisetup{locale = FR}

%%%%%%%%%%
%  TikZ  %
%%%%%%%%%%

\usepackage[framemethod=TikZ]{mdframed}
\usepackage{tikz}
\usepackage{tikz-cd}

\usetikzlibrary{intersections, angles, quotes, calc, positioning}
\usetikzlibrary{arrows.meta}

\tikzset{
  force/.style={thick, {Circle[length=2pt]}-stealth, shorten <=-1pt}
}

%%%%%%%%%%%%%%%
%  PGF Plots  %
%%%%%%%%%%%%%%%

\usepackage{pgfplots}
\pgfplotsset{compat=1.13}

%%%%%%%%%%%%%%%%%%%%%%%
%  Center Title Page  %
%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{titling}
\renewcommand\maketitlehooka{\null\mbox{}\vfill}
\renewcommand\maketitlehookd{\vfill\null}

%%%%%%%%%%%%%%%%%%%
%  Todo Commands  %
%%%%%%%%%%%%%%%%%%%

\usepackage[colorinlistoftodos]{todonotes}
\makeatletter
\@ifclasswith\class{working}{
  \newcommand\unsure[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
  \newcommand\change[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
  \newcommand\info[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
  \newcommand\improvement[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}

  \newcommand\listnotes{
    \newpage
    \listoftodos[Notes]
  }
}{
  \newcommand\unsure[2][1=]{}
  \newcommand\change[2][1=]{}
  \newcommand\info[2][1=]{}
  \newcommand\improvement[2][1=]{}

  \newcommand\listnotes{}
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Create a grey background in the middle of the PDF  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \usepackage{eso-pic}
% \definecolor{reallylightgray}{HTML}{FAFAFA}
% \AddToShipoutPicture{
%   \ifthenelse{\isodd{\thepage}}{
%     \AtPageLowerLeft{
%       \put(\LenToUnit{\dimexpr\paperwidth-222pt},0){
%         \color{reallylightgray}\rule{222pt}{297mm}
%       }
%     }
%   }
%   {
%     \AtPageLowerLeft{
%       \color{reallylightgray}\rule{222pt}{297mm}
%     }
%   }
% }

%%%%%%%%%%%%%%%%%%%%%%%%
%  Modify Links Color  %
%%%%%%%%%%%%%%%%%%%%%%%%

\hypersetup{
  % Enable highlighting links.
  colorlinks,
  % Change the color of links to blue.
  linkcolor=blue,
  % Change the color of citations to black.
  citecolor={black},
  % Change the color of url's to blue with some black.
  urlcolor={blue!80!black}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           School Specific Commands                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Initiate New Counters  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcounter{lecturecounter}
\newcounter{exercisecounter}
\newcounter{solutioncounter}

%%%%%%%%%%%%%%%%%%%%%
%  Lecture Command  %
%%%%%%%%%%%%%%%%%%%%%

\makeatletter

\usepackage{xifthen}

% EXAMPLE:
% 1. \lesson{Oct 17 2022 Mon (08:46:48)}{Lecture Title}
% 2. \lesson[4]{Oct 17 2022 Mon (08:46:48)}{Lecture Title}
% 3. \lesson{Oct 17 2022 Mon (08:46:48)}{}
% 4. \lesson[4]{Oct 17 2022 Mon (08:46:48)}{}
% Parameters:
% 1. (Optional) Lesson number.
% 2. Time and date of lecture.
% 3. Lecture Title.
\def\@lesson{}
\newcommand\lesson[3][\arabic{lecturecounter}]{
  % Add 1 to the lecture counter.
  \addtocounter{lecturecounter}{1}

  % Set the section number to the lecture counter.
  \setcounter{section}{#1}

  % Reset the exercise and solution counter back to 0.
  \setcounter{exercisecounter}{0}
  \setcounter{solutioncounter}{0}

  \renewcommand\thesubsection{#1.\arabic{subsection}}

  % Check if user passed the lecture title or not.
  \ifthenelse{\isempty{#3}}{
    \def\@lesson{Lecture \arabic{lecturecounter}}
  }{
    \def\@lesson{Lecture \arabic{lecturecounter}: #3}
  }

  % Display the information like the following:
  %                                                  Oct 17 2022 Mon (08:49:10)
  % ---------------------------------------------------------------------------
  % Lecture 1: Lecture Title
  \hfill\small{#2}
  \hrule
  \vspace*{-0.3cm}
  \section*{\@lesson}
  \addcontentsline{toc}{section}{\@lesson}
}

%%%%%%%%%%%%%%%%%%%%%%
%  Exercise Command  %
%%%%%%%%%%%%%%%%%%%%%%

% EXAMPLE:
% 1. \exercise
% 2. \exercise[3]
% Parameters:
% 1. (Optional) The exercise number. You don't need to add this, because by
%    default, a counter will be doing it for you. Here's an example: 5.7. The
%    first number is the section number, and the second number is the exercise
%    number.
\def\@exercise{}
\newcommand\exercise[1][\arabic{exercisecounter}]{
  % Add 1 to the exercise counter.
  \addtocounter{exercisecounter}{1}

  % Edit the \@exercise variable.
  \def\@exercise{Exercise \arabic{section}.#1}
  % Create a subsection without numbering.
  \subsection*{\@exercise}
  % Add the subsection to the table of contents.
  \addcontentsline{toc}{subsection}{\@exercise}
}

%%%%%%%%%%%%%%%%%%%%%%
%  Solution Command  %
%%%%%%%%%%%%%%%%%%%%%%

% EXAMPLE:
% 1. \solution
% 2. \solution[3]
% Parameters:
% 1. (Optional) The solution number. You don't need to add this, because by
%    default, a counter will be doing it for you. Here's an example: 5.7. The
%    first number is the section number, and the second number is the solution
%    number.
\def\@solution{}
\newcommand\solution[1][\arabic{solutioncounter}]{
  % Add 1 to the solution counter.
  \addtocounter{solutioncounter}{1}

  % Edit the \@solution variable.
  \def\@solution{Solution \arabic{section}.#1}
  % Create a subsection without numbering.
  \subsection*{\@solution}
  % Add the subsection to the table of contents.
  \addcontentsline{toc}{subsection}{\@solution}
}

%%%%%%%%%%%%%%%%%%%%
%  Import Figures  %
%%%%%%%%%%%%%%%%%%%%

\usepackage{import}
\pdfminorversion=7

% EXAMPLE:
% 1. \incfig{limit-graph}
% 2. \incfig[0.4]{limit-graph}
% Parameters:
% 1. The figure name. It should be located in figures/NAME.tex_pdf.
% 2. (Optional) The width of the figure. Example: 0.5, 0.35.
\newcommand\incfig[2][1]{%
  \def\svgwidth{#1\columnwidth}
  \import{./figures/}{#2.pdf_tex}
}

\begingroup\expandafter\expandafter\expandafter\endgroup
\expandafter\ifx\csname pdfsuppresswarningpagegroup\endcsname\relax
\else
  \pdfsuppresswarningpagegroup=1\relax
\fi

%%%%%%%%%%%%%
%  Correct  %
%%%%%%%%%%%%%

% EXAMPLE:
% 1. \correct{INCORRECT}{CORRECT}
% Parameters:
% 1. The incorrect statement.
% 2. The correct statement.
\definecolor{correct}{HTML}{009900}
\newcommand\correct[2]{{\color{red}{#1 }}\ensuremath{\to}{\color{correct}{ #2}}}

%%%%%%%%%%%%%%%%%
% Fancy Headers %
%%%%%%%%%%%%%%%%%

\usepackage{fancyhdr}
\newcommand\forcenewpage{\clearpage\mbox{~}\clearpage\newpage}
\newcommand\createintro{
  \pagenumbering{roman}

  \maketitle
  \thispagestyle{empty}
  \newpage
  \input{intro}

  \pagestyle{fancy}
  \renewcommand\headrulewidth{0pt}
  \fancyhead{}
  \fancyfoot[C]{
    \textit{For more notes like this, visit
    \href{singularisart.github.io/notes}{singularisart.github.io/notes}}. \\
    \vspace{0.1cm}
    \hrule
    \vspace{0.1cm}
    Hashem A. Damrah, \\
    \term: \academicyear, \\
    Last Update: \today, \\
    \faculty
  }

  \newpage

  \fancyfoot[C]{\thepage}
  \tableofcontents
  \forcenewpage

  \pagestyle{fancy}
  \pagenumbering{arabic}
  \setcounter{page}{1}

  \renewcommand\headrulewidth{0.4pt}
  \fancyhead[R]{\@lesson}
  \fancyhead[L]{Hashem A. Damrah}
  \fancyfoot[C]{\thepage}
}

\makeatother


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                 Environments                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\mdfsetup{skipabove=1em,skipbelow=0em}
\theoremstyle{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Helpful New Commands  %
%%%%%%%%%%%%%%%%%%%%%%%%%%

% EXAMPLE:
% 1. \createnewtheorem{thmredbox}{}{}
% 2. \createnewtheorem{thmbluebox}{}{}
% 3. \createnewtheorem{thmblueline}{rightline=false, topline=false, bottomline=false}{}
% 4. \createnewtheorem{thmproofbox}{rightline=false, topline=false, bottomline=false}{qed=\qedsymbol}
% Parameters:
% 1. Theorem name.
% 2. Any extra parameters to pass to mdframed.
% 3. Any extra parameters to pass to declare theorem directly.
\newcommand\createnewtheorem[3]{
  \declaretheoremstyle[
  headfont=\bfseries\sffamily, bodyfont=\normalfont, #3,
  mdframed={
    #2
  },
  ]{#1}
}

% EXAMPLE:
% 1. \createcoloredtheorem{thmredbox}{RawSienna}{false}{true}{false}{false}{}{}
% 2. \createcoloredtheorem{thmbluebox}{NavyBlue}{false}{true}{false}{false}{}{}
% 3. \createcoloredtheorem{thmblueline}{NavyBlue}{false}{true}{false}{false}{backgroundcolor=white}{}
% 4. \createcoloredtheorem{thmproofbox}{RawSienna}{false}{true}{false}{false}{backgroundcolor=white}{qed=\qedsymbol}
% Parameters:
% 1. Theorem name.
% 2. Color of theorem.
% 3. Enable right line.
% 4. Enable left line.
% 5. Enable top line.
% 6. Enable bottom line.
% 7. Any extra parameters to pass to mdframed.
% 8. Any extra parameters to pass to declare theorem directly.
\newcommand\createcoloredtheorem[8]{
  \createnewtheorem{#1}{
    linewidth=2pt,
    rightline=#3, leftline=#4, topline=#5, bottomline=#6,
    linecolor=#2, backgroundcolor=#2!5, #7
  }{headfont=\bfseries\sffamily\color{#2}, #8}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Create Environments Styles Based on Given Parameter  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{thmtools}
\usepackage{tcolorbox}

\makeatletter
\@ifclasswith\class{nocolor}{
  % No color environments.
  \createnewtheorem{thmgreenbox}{}{}
  \createnewtheorem{thmredbox}{}{}
  \createnewtheorem{thmbluebox}{}{}
  \createnewtheorem{thmblueline}{rightline=false, topline=false, bottomline=false}{}
  \createnewtheorem{thmproofbox}{rightline=false, topline=false, bottomline=false}{qed=\qedsymbol}
}{
  % Color environments.
  \createcoloredtheorem{thmgreenbox}{ForestGreen}{false}{true}{false}{false}{}{}
  \createcoloredtheorem{thmredbox}{RawSienna}{false}{true}{false}{false}{}{}
  \createcoloredtheorem{thmbluebox}{NavyBlue}{false}{true}{false}{false}{}{}
  \createcoloredtheorem{thmblueline}{NavyBlue}{false}{true}{false}{false}{backgroundcolor=white}{}
  \createcoloredtheorem{thmproofbox}{RawSienna}{false}{true}{false}{false}{backgroundcolor=white}{qed=\qedsymbol}
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Create the Environments  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\declaretheorem[numberwithin=section, style=thmgreenbox, name=Definition]{definition}
\declaretheorem[sibling=definition, style=thmredbox, name=Corollary]{corollary}
\declaretheorem[sibling=definition, style=thmredbox, name=Proposition]{prop}
\declaretheorem[sibling=definition, style=thmredbox, name=Theorem]{theorem}
\declaretheorem[sibling=definition, style=thmredbox, name=Lemma]{lemma}
\declaretheorem[numbered=no, style=thmproofbox, name=Proof]{replacementproof}
\declaretheorem[numbered=no, style=thmblueline, name=Proof]{expl}
\declaretheorem[style=thmbluebox, numbered=no, name=Example]{example}
\declaretheorem[style=thmblueline, numbered=no, name=Remark]{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Edit Proof Environment  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewenvironment{proof}[1][\proofname]{\vspace{-10pt}\begin{replacementproof}}{\end{replacementproof}}
\newenvironment{explanation}[1][\proofname]{\vspace{-10pt}\begin{expl}}{\end{expl}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Create Simple Environments  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newtheorem*{notation}{Notation}
\newtheorem*{previouslyseen}{As previously seen}
\newtheorem*{problem}{Problem}
\newtheorem*{observe}{Observe}
\newtheorem*{property}{Property}
\newtheorem*{intuition}{Intuition}
\newtheorem*{note}{Note}
